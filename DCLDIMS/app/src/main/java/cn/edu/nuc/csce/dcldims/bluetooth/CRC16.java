package cn.edu.nuc.csce.dcldims.bluetooth;

/**
 * Created by tdg on 2016/10/6.
 */

public class CRC16 {
    static int  CRC16Table[] = {
            (int)0x0000,(int)0xC0C1,(int)0xC181,(int)0x0140,(int)0xC301,(int)0x03C0,(int)0x0280,(int)0xC241,
            (int)0xC601,(int)0x06C0,(int)0x0780,(int)0xC741,(int)0x0500,(int)0xC5C1,(int)0xC481,(int)0x0440,
            (int)0xCC01,(int)0x0CC0,(int)0x0D80,(int)0xCD41,(int)0x0F00,(int)0xCFC1,(int)0xCE81,(int)0x0E40,
            (int)0x0A00,(int)0xCAC1,(int)0xCB81,(int)0x0B40,(int)0xC901,(int)0x09C0,(int)0x0880,(int)0xC841,
            (int)0xD801,(int)0x18C0,(int)0x1980,(int)0xD941,(int)0x1B00,(int)0xDBC1,(int)0xDA81,(int)0x1A40,
            (int)0x1E00,(int)0xDEC1,(int)0xDF81,(int)0x1F40,(int)0xDD01,(int)0x1DC0,(int)0x1C80,(int)0xDC41,
            (int)0x1400,(int)0xD4C1,(int)0xD581,(int)0x1540,(int)0xD701,(int)0x17C0,(int)0x1680,(int)0xD641,
            (int)0xD201,(int)0x12C0,(int)0x1380,(int)0xD341,(int)0x1100,(int)0xD1C1,(int)0xD081,(int)0x1040,
            (int)0xF001,(int)0x30C0,(int)0x3180,(int)0xF141,(int)0x3300,(int)0xF3C1,(int)0xF281,(int)0x3240,
            (int)0x3600,(int)0xF6C1,(int)0xF781,(int)0x3740,(int)0xF501,(int)0x35C0,(int)0x3480,(int)0xF441,
            (int)0x3C00,(int)0xFCC1,(int)0xFD81,(int)0x3D40,(int)0xFF01,(int)0x3FC0,(int)0x3E80,(int)0xFE41,
            (int)0xFA01,(int)0x3AC0,(int)0x3B80,(int)0xFB41,(int)0x3900,(int)0xF9C1,(int)0xF881,(int)0x3840,
            (int)0x2800,(int)0xE8C1,(int)0xE981,(int)0x2940,(int)0xEB01,(int)0x2BC0,(int)0x2A80,(int)0xEA41,
            (int)0xEE01,(int)0x2EC0,(int)0x2F80,(int)0xEF41,(int)0x2D00,(int)0xEDC1,(int)0xEC81,(int)0x2C40,
            (int)0xE401,(int)0x24C0,(int)0x2580,(int)0xE541,(int)0x2700,(int)0xE7C1,(int)0xE681,(int)0x2640,
            (int)0x2200,(int)0xE2C1,(int)0xE381,(int)0x2340,(int)0xE101,(int)0x21C0,(int)0x2080,(int)0xE041,
            (int)0xA001,(int)0x60C0,(int)0x6180,(int)0xA141,(int)0x6300,(int)0xA3C1,(int)0xA281,(int)0x6240,
            (int)0x6600,(int)0xA6C1,(int)0xA781,(int)0x6740,(int)0xA501,(int)0x65C0,(int)0x6480,(int)0xA441,
            (int)0x6C00,(int)0xACC1,(int)0xAD81,(int)0x6D40,(int)0xAF01,(int)0x6FC0,(int)0x6E80,(int)0xAE41,
            (int)0xAA01,(int)0x6AC0,(int)0x6B80,(int)0xAB41,(int)0x6900,(int)0xA9C1,(int)0xA881,(int)0x6840,
            (int)0x7800,(int)0xB8C1,(int)0xB981,(int)0x7940,(int)0xBB01,(int)0x7BC0,(int)0x7A80,(int)0xBA41,
            (int)0xBE01,(int)0x7EC0,(int)0x7F80,(int)0xBF41,(int)0x7D00,(int)0xBDC1,(int)0xBC81,(int)0x7C40,
            (int)0xB401,(int)0x74C0,(int)0x7580,(int)0xB541,(int)0x7700,(int)0xB7C1,(int)0xB681,(int)0x7640,
            (int)0x7200,(int)0xB2C1,(int)0xB381,(int)0x7340,(int)0xB101,(int)0x71C0,(int)0x7080,(int)0xB041,
            (int)0x5000,(int)0x90C1,(int)0x9181,(int)0x5140,(int)0x9301,(int)0x53C0,(int)0x5280,(int)0x9241,
            (int)0x9601,(int)0x56C0,(int)0x5780,(int)0x9741,(int)0x5500,(int)0x95C1,(int)0x9481,(int)0x5440,
            (int)0x9C01,(int)0x5CC0,(int)0x5D80,(int)0x9D41,(int)0x5F00,(int)0x9FC1,(int)0x9E81,(int)0x5E40,
            (int)0x5A00,(int)0x9AC1,(int)0x9B81,(int)0x5B40,(int)0x9901,(int)0x59C0,(int)0x5880,(int)0x9841,
            (int)0x8801,(int)0x48C0,(int)0x4980,(int)0x8941,(int)0x4B00,(int)0x8BC1,(int)0x8A81,(int)0x4A40,
            (int)0x4E00,(int)0x8EC1,(int)0x8F81,(int)0x4F40,(int)0x8D01,(int)0x4DC0,(int)0x4C80,(int)0x8C41,
            (int)0x4400,(int)0x84C1,(int)0x8581,(int)0x4540,(int)0x8701,(int)0x47C0,(int)0x4680,(int)0x8641,
            (int)0x8201,(int)0x42C0,(int)0x4380,(int)0x8341,(int)0x4100,(int)0x81C1,(int)0x8081,(int)0x4040
    };

    public static int calcCrc16(byte[] p)
    {
        int checksum = 0;
        for( int i=0; i < p.length; i++ )
        {
            checksum = ( checksum >> 8 ) ^ CRC16Table[ (checksum&0xFF) ^ (p[i] & 0xff) ];
        }
        return checksum;
    }
}
